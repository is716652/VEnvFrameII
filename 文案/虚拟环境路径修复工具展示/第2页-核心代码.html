<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VEnvFrame è™šæ‹Ÿç¯å¢ƒè·¯å¾„ä¿®å¤å·¥å…· - ç¬¬2é¡µ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .ppt-slide {
            width: 1280px;
            height: 720px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.3);
            overflow: hidden;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .slide-header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 25px 40px;
            text-align: center;
            position: relative;
        }

        .slide-title {
            font-size: 2.2em;
            font-weight: bold;
            margin-bottom: 8px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .slide-subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .slide-content {
            flex: 1;
            padding: 20px;
            background: #f8f9fa;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .code-section {
            background: #2d3748;
            color: #e2e8f0;
            border-radius: 12px;
            padding: 0;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            line-height: 1.4;
            overflow: hidden;
            position: relative;
        }

        .code-header {
            background: #1a202c;
            color: #4facfe;
            padding: 12px 15px;
            font-weight: bold;
            display: flex;
            align-items: center;
            border-bottom: 1px solid #4a5568;
        }

        .code-icon {
            margin-right: 10px;
            font-size: 1.3em;
        }

        .code-body {
            padding: 15px;
            height: 520px;
            overflow-y: auto;
        }

        .bat-code {
            color: #98fb98;
        }

        .python-code {
            color: #ffd700;
        }

        .comment {
            color: #68d391;
            font-style: italic;
        }

        .string {
            color: #fbb6ce;
        }

        .keyword {
            color: #63b3ed;
            font-weight: bold;
        }

        .function {
            color: #f6ad55;
        }

        .variable {
            color: #ed8936;
        }

        .page-number {
            position: absolute;
            bottom: 20px;
            right: 30px;
            background: rgba(102, 126, 234, 0.8);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 1.1em;
            font-weight: bold;
        }

        .watermark {
            position: absolute;
            bottom: 20px;
            left: 30px;
            color: rgba(102, 126, 234, 0.6);
            font-size: 1em;
        }
    </style>
</head>
<body>
    <div class="ppt-slide">
        <div class="slide-header">
            <h1 class="slide-title">ğŸ“‹ æ ¸å¿ƒä»£ç å®ç°</h1>
            <p class="slide-subtitle">Windowsæ‰¹å¤„ç†è„šæœ¬ + Pythonæ ¸å¿ƒé€»è¾‘</p>
        </div>

        <div class="slide-content">
            <div class="code-section">
                <div class="code-header">
                    <span class="code-icon">ğŸ“„</span>
                    fix_venv_path.bat - Windowsæ‰¹å¤„ç†å…¥å£
                </div>
                <div class="code-body bat-code">
<span class="comment">@echo off</span>
<span class="comment">chcp 65001 >nul</span>
<span class="keyword">echo</span> <span class="string">========================================</span>
<span class="keyword">echo</span> <span class="string">è™šæ‹Ÿç¯å¢ƒè·¯å¾„è‡ªåŠ¨ä¿®å¤å·¥å…·</span>
<span class="keyword">echo</span> <span class="string">========================================</span>
<span class="keyword">echo</span>.

<span class="comment">REM æ£€æŸ¥Pythonæ˜¯å¦å¯ç”¨</span>
<span class="function">python</span> --version >nul 2>&1
<span class="keyword">if</span> %errorlevel% <span class="keyword">neq</span> 0 (
    <span class="keyword">echo</span> <span class="string">é”™è¯¯: æœªæ‰¾åˆ°Pythonï¼Œè¯·ç¡®ä¿Pythonå·²å®‰è£…å¹¶æ·»åŠ åˆ°PATHç¯å¢ƒå˜é‡</span>
    <span class="keyword">pause</span>
    <span class="keyword">exit</span> /b 1
)

<span class="comment">REM è¿è¡Œä¿®å¤è„šæœ¬</span>
<span class="function">python</span> <span class="string">Tools\fix_venv_path.py</span>

<span class="keyword">echo</span>.
<span class="keyword">echo</span> <span class="string">æŒ‰ä»»æ„é”®é€€å‡º...</span>
<span class="keyword">pause</span> >nul
                </div>
            </div>

            <div class="code-section">
                <div class="code-header">
                    <span class="code-icon">ğŸ</span>
                    fix_venv_path.py - Pythonæ ¸å¿ƒä¿®å¤é€»è¾‘
                </div>
                <div class="code-body python-code">
<span class="comment">#!/usr/bin/env python3</span>
<span class="comment"># -*- coding: utf-8 -*-</span>
<span class="string">"""
è™šæ‹Ÿç¯å¢ƒè·¯å¾„è‡ªåŠ¨ä¿®å¤è„šæœ¬
å½“é¡¹ç›®ç§»æ¤åˆ°å…¶ä»–æœºå™¨æ—¶ï¼Œè‡ªåŠ¨æ£€æµ‹å¹¶ä¿®å¤è™šæ‹Ÿç¯å¢ƒä¸­çš„Pythonè·¯å¾„é…ç½®
"""</span>

<span class="keyword">import</span> os
<span class="keyword">import</span> sys
<span class="keyword">import</span> shutil
<span class="keyword">import</span> subprocess
<span class="keyword">from</span> pathlib <span class="keyword">import</span> Path

<span class="keyword">def</span> <span class="function">find_python_executable</span>():
    <span class="string">"""æŸ¥æ‰¾å½“å‰ç³»ç»Ÿä¸­çš„Python 3.12å¯æ‰§è¡Œæ–‡ä»¶"""</span>
    <span class="variable">possible_paths</span> = [
        <span class="comment"># Windowså¸¸è§è·¯å¾„</span>
        <span class="string">r"C:\Python312\python.exe"</span>,
        <span class="string">r"C:\Python\Python312\python.exe"</span>,
        <span class="string">r"C:\Users\{}\Python\Python312\python.exe"</span>.<span class="function">format</span>(
            os.<span class="function">getenv</span>(<span class="string">'USERNAME'</span>, <span class="string">''</span>)),
        <span class="string">r"C:\Users\{}\AppData\Local\Programs\Python\Python312\python.exe"</span>.<span class="function">format</span>(
            os.<span class="function">getenv</span>(<span class="string">'USERNAME'</span>, <span class="string">''</span>)),
        <span class="string">r"C:\Program Files\Python312\python.exe"</span>,
        <span class="string">r"C:\Program Files (x86)\Python312\python.exe"</span>,
        <span class="comment"># é€šè¿‡PATHç¯å¢ƒå˜é‡æŸ¥æ‰¾</span>
        shutil.<span class="function">which</span>(<span class="string">"python"</span>),
        shutil.<span class="function">which</span>(<span class="string">"python3"</span>),
        shutil.<span class="function">which</span>(<span class="string">"python3.12"</span>),
    ]
    
    <span class="keyword">for</span> <span class="variable">path</span> <span class="keyword">in</span> <span class="variable">possible_paths</span>:
        <span class="keyword">if</span> <span class="variable">path</span> <span class="keyword">and</span> os.path.<span class="function">exists</span>(<span class="variable">path</span>):
            <span class="keyword">try</span>:
                <span class="comment"># éªŒè¯Pythonç‰ˆæœ¬</span>
                <span class="variable">result</span> = subprocess.<span class="function">run</span>([<span class="variable">path</span>, <span class="string">"--version"</span>], 
                                      capture_output=<span class="keyword">True</span>, text=<span class="keyword">True</span>, timeout=10)
                <span class="keyword">if</span> <span class="variable">result</span>.returncode == 0 <span class="keyword">and</span> <span class="string">"3.12"</span> <span class="keyword">in</span> <span class="variable">result</span>.stdout:
                    <span class="keyword">return</span> os.path.<span class="function">abspath</span>(<span class="variable">path</span>)
            <span class="keyword">except</span> (subprocess.TimeoutExpired, subprocess.SubprocessError):
                <span class="keyword">continue</span>
    
    <span class="keyword">return</span> <span class="keyword">None</span>

<span class="keyword">def</span> <span class="function">fix_pyvenv_cfg</span>(<span class="variable">venv_path</span>, <span class="variable">python_exe</span>):
    <span class="string">"""ä¿®å¤pyvenv.cfgæ–‡ä»¶ä¸­çš„è·¯å¾„é…ç½®"""</span>
    <span class="variable">pyvenv_cfg</span> = os.path.<span class="function">join</span>(<span class="variable">venv_path</span>, <span class="string">"pyvenv.cfg"</span>)
    
    <span class="keyword">if</span> <span class="keyword">not</span> os.path.<span class="function">exists</span>(<span class="variable">pyvenv_cfg</span>):
        <span class="function">print</span>(<span class="string">f"é”™è¯¯: æ‰¾ä¸åˆ° {pyvenv_cfg}"</span>)
        <span class="keyword">return</span> <span class="keyword">False</span>
    
    <span class="comment"># è¯»å–åŸé…ç½®</span>
    <span class="keyword">with</span> <span class="function">open</span>(<span class="variable">pyvenv_cfg</span>, <span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> <span class="variable">f</span>:
        <span class="variable">lines</span> = <span class="variable">f</span>.<span class="function">readlines</span>()
    
    <span class="comment"># ä¿®æ”¹é…ç½®</span>
    <span class="variable">python_home</span> = os.path.<span class="function">dirname</span>(<span class="variable">python_exe</span>)
    <span class="variable">new_lines</span> = []
    
    <span class="keyword">for</span> <span class="variable">line</span> <span class="keyword">in</span> <span class="variable">lines</span>:
        <span class="keyword">if</span> <span class="variable">line</span>.<span class="function">startswith</span>(<span class="string">'home = '</span>):
            <span class="variable">new_lines</span>.<span class="function">append</span>(<span class="string">f'home = {python_home}\n'</span>)
            <span class="function">print</span>(<span class="string">f"æ›´æ–° home è·¯å¾„: {python_home}"</span>)
        <span class="keyword">elif</span> <span class="variable">line</span>.<span class="function">startswith</span>(<span class="string">'executable = '</span>):
            <span class="variable">new_lines</span>.<span class="function">append</span>(<span class="string">f'executable = {python_exe}\n'</span>)
            <span class="function">print</span>(<span class="string">f"æ›´æ–° executable è·¯å¾„: {python_exe}"</span>)
        <span class="keyword">else</span>:
            <span class="variable">new_lines</span>.<span class="function">append</span>(<span class="variable">line</span>)
    
    <span class="comment"># å†™å…¥æ–°é…ç½®</span>
    <span class="keyword">with</span> <span class="function">open</span>(<span class="variable">pyvenv_cfg</span>, <span class="string">'w'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> <span class="variable">f</span>:
        <span class="variable">f</span>.<span class="function">writelines</span>(<span class="variable">new_lines</span>)
    
    <span class="keyword">return</span> <span class="keyword">True</span>
                </div>
            </div>
        </div>

        <div class="page-number">2/3</div>
        <div class="watermark">CodeBuddy AI Generated - VEnvFrame</div>
    </div>
</body>
</html>